# t

!['å­—ç¬¦æ‰“ç‚¹'](./img/2019-12-26.png)

## tt

```js
// ç¬¬ä¸€é¢˜
function elsMid(str, len) {
    var t = len || 15;
    if (str.length > t) {
        var after = parseInt(t / 2) - 1;
        return str.slice(0, t - after - 3) + '...' + str.slice(-after);
    }
    return str
}

console.log(elsMid('è¿™æ˜¯ä¸€æ®µå¾ˆé•¿çš„æ–‡å­—ï¼Œéœ€è¦ä¸­é—´çœç•¥ï¼Œå› ä¸ºé¦–å°¾çš„ä¿¡æ¯éƒ½å¾ˆé‡è¦'));

// ç¬¬äºŒé¢˜
function elsFilename(str, len) {
    var t = len || 15;
    if (str.length > t) {
        var after = str.split('.').slice(-1)[0].length + 2; //æœ€åŽä¸€ä¸ªç‚¹
        return str.slice(0, t - after - 3) + '...' + str.slice(-after);
    }
    return str
}

console.log(elsFilename('weixin_20191254656563.jpg'));
console.log(elsFilename('weixin_20191254611.bak.word'));

// ç¬¬ä¸‰é¢˜
function elsEmoji(str, len) {
    var t = len || 15;
    var emojiArr = str.replace(/â€”â€”|â€¦â€¦|[^\ud83c|\ud83d]/g, function ($0) {
        if (/â€”â€”|â€¦â€¦/.test($0)) {
            return $0 + ',';
        }
        if (/[\u2000-\u2fff]/g.test($0)) {
            return $0
        }
        return $0 + ',';
    }).slice(0, -1).split(','); //è½¬åŒ–æˆæ•°ç»„ï¼Œä¸çŸ¥é“è¿™æ ·å…¨ä¸å…¨

    if (emojiArr.length >= t) {
        var reg = /\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]|[\u2000-\u2fff]|â€”â€”|â€¦â€¦|ï¼Œ|ï¼š|ï¼›/g
        var mid = parseInt(emojiArr.length / 2);
        var before = emojiArr.slice(0, mid);
        var after = emojiArr.slice(mid);
        var index = 0;
        for (var i = 0; i < mid; i++) {
            if (reg.test(before[mid - i - 1])) {
                index = mid - i - 1;
                break;
            }
            if (reg.test(after[i])) {
                index = mid + i;
                break;
            }
        }

        var start = t - (emojiArr.length - index - 1) - 3;
        if (start <= 0 || index === emojiArr.length) {
            return elsMid(str);
        } else {
            return emojiArr.slice(0, start).join('') + '...' + emojiArr.slice(index + 1).join('');
        }
    }
    return str
}

console.log(elsEmoji('ðŸŽ…ðŸŽ„ðŸŽâ¤ï¸ðŸš€ðŸš€ðŸš€åœ£è¯žå¿«ä¹ï¼Œç³»åˆ—æœ‰ðŸš€äº†'))
console.log(elsEmoji('ðŸŽ…ðŸŽ„ðŸŽâ¤ï¸ðŸš€â¤ï¸åœ£è¯žå¿«ä¹ï¼Œç³»åˆ—æœ‰ðŸš€äº†'))
console.log(elsEmoji('ðŸŽ…ðŸŽ„ðŸŽå¤§å®¶åœ£è¯žå¿«ä¹â€”â€”ç³»åˆ—æœ‰ðŸš€äº†'))
console.log(elsEmoji('ðŸŽ…ðŸŽ„ðŸŽå¤§å®¶åœ£è¯žå¿«ä¹â¤ï¸ç³»åˆ—æœ‰ðŸš€äº†'))
console.log(elsEmoji('ðŸŽ…ðŸŽ„ðŸŽå¤§å®¶åœ£è¯žå¿«ä¹â€¦â€¦ç³»åˆ—æœ‰ðŸš€äº†'))
```
