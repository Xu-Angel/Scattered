>送你一份微信小程序 web-view 开发踩坑大全
https://imweb.io/topic/5c0aa26f611a25cc7bf1d7ea
对于开发者来说，如果 H5 页面能够直接嵌入到小程序那是再好不过了，而 web-view 组件正好就提供了这么个功能（个人类型与海外类型的小程序暂不支持使用）。简单来说它是一个可以用来承载网页的容器，会自动铺满整个小程序页面。 虽然这带来了很大的便利，但是也还是有很多需要注意的地方。

配置业务域名的时候会提示需要上传验证文件到该域名下进行验证。如果该域名下没有验证文件或验证文件错误，则 web-view 页面直接提示报错，无法正常访问。

除此之外，如果页面中有其他链接跳转到非业务域名，进行跳转的时候也会报错导致无法正常访问，如富文本内容中的链接，iframe，数据上报或支付跳转等其他非业务域名。

**另外：避免在链接中带有中文字符，在 iOS 中会有打开白屏的问题，建议加一下 encodeURIComponent**

## 组件层级
web-view 组件属于原生组件，所以层级很高，如果需要覆盖则需要使用 cover-view 组件。但是 cover-view 组件在开发工具上是看不到覆盖效果的，安卓默认也不能覆盖，只有 IOS 默认会覆盖。所以为了得到想要的效果，得使用一些非常手段：

对于安卓的默认不能覆盖，目前的解决方案是执行 setTimeout 延迟实现 cover-view 的显示，让 web-view 先显示，cover-view 后显示。
对于开发工具看不到，如要调试效果则可以先注释掉 web-view 组件
除此之外，封装一个组件的时候，如果需要盖住 web-view，肯定得选择 cover-view 组件。但是如果这个组件不仅应用在 web-view 页面，还应用在普通的小程序页面。 cover-view 又会引来另一个问题：弹窗浮层根本盖不住。如一些右下角的咨询按钮，既应用在小程序页面中，也应用在 web-view 页面中。所以做组件的时候可以做一个属性判断，如果是 web-view 页面则使用 cover-view，否则使用 view。

另外 cover-view 组件中的 button 组件并不是真的，而是用 cover-view 模拟出来的。所以修改样式的话，需要注意点。